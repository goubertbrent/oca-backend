<form #form="ngForm" (ngSubmit)="submit(form)">
  <h3>{{ 'oca.default_map_position' | translate }}</h3>
  <agm-map class="location-map"
           gestureHandling="cooperative"
           [zoom]="12"
           [scrollwheel]="null"
           [latitude]="mapConfig.center.lat"
           [longitude]="mapConfig.center.lon">
    <agm-circle [latitude]="mapConfig.center.lat"
                [longitude]="mapConfig.center.lon"
                [editable]="true"
                [(radius)]="mapConfig.distance"
                (centerChange)="setNewCenter($event)"></agm-circle>
  </agm-map>
  <mat-form-field>
    <mat-label>{{ 'oca.filters' | translate }}</mat-label>
    <mat-select [multiple]="true" name="filters" [(ngModel)]="mapConfig.filters" required>
      <mat-option *ngFor="let filter of filters" [value]="filter.value">{{ filter.label | translate }}</mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field>
    <mat-label>{{ 'oca.default_filter' | translate }}</mat-label>
    <mat-select name="default_filter" [(ngModel)]="mapConfig.default_filter" required>
      <ng-container *ngFor="let filter of filters">
        <mat-option [value]="filter.value" *ngIf="mapConfig.filters.includes(filter.value)">
          {{ filter.label | translate }}
        </mat-option>
      </ng-container>
    </mat-select>
  </mat-form-field>
  <ng-container *ngFor="let button of mapConfig.buttons; let i = index">
    <h4>{{ 'oca.button_x' | translate : {button: i + 1}  }}</h4>
    <button type="button" mat-stroked-button (click)="removeButton(button)">
      <mat-icon>close</mat-icon>
      {{ 'oca.delete' | translate }}
    </button>
    <mat-form-field>
      <mat-label>{{ 'oca.Label' | translate }}</mat-label>
      <input type="text" matInput [name]="'text' + i" [(ngModel)]="button.text">
    </mat-form-field>
    <mat-form-field>
      <mat-label>{{ 'oca.Icon' | translate }}</mat-label>
      <input type="text" matInput [name]="'icon' + i" [(ngModel)]="button.icon">
      <mat-hint>See <a href="https://fontawesome.com/v4.7.0/icons">https://fontawesome.com/v4.7.0/icons</a></mat-hint>
    </mat-form-field>
    <mat-form-field>
      <mat-label>{{ 'oca.action' | translate }}</mat-label>
      <input type="url" matInput [name]="'action' + i" [(ngModel)]="button.action" required>
    </mat-form-field>
    <mat-form-field>
      <mat-label>{{ 'oca.color' | translate }}</mat-label>
      <input type="text" matInput [name]="'color' + i" [(ngModel)]="button.color">
    </mat-form-field>
  </ng-container>
  <button type="button" mat-stroked-button (click)="addButton()">{{ 'oca.add_button' | translate }}</button>
  <div class="button-container">
    <button mat-raised-button>{{ 'oca.Save' | translate }}</button>
  </div>
</form>
